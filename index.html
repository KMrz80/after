<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ö–æ—Ç–∏–∫ –ø–æ—Å–ª–µ —É—Ä–æ–∫–æ–≤</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    /* ==================================================
       RESET / BASE
    ================================================== */
    * {
      box-sizing: border-box;
      font-family: Arial, sans-serif;
    }

    body {
      margin: 0;
      height: 100vh;
      background: #1e1e1e;
      color: #fff;
      display: flex;
    }

    button {
      cursor: pointer;
      border: none;
      border-radius: 8px;
    }

    /* ==================================================
       LEFT PANEL
    ================================================== */
    .sidebar {
      width: 240px;
      background: #0f172a;
      padding: 16px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .sidebar h2 {
      margin: 0 0 12px;
      font-size: 16px;
      opacity: 0.9;
    }

    .sidebar button {
      padding: 12px;
      background: #1f2937;
      color: #fff;
      transition: background 0.2s, opacity 0.2s;
      position: relative;
    }

    .sidebar button:hover:not(:disabled) {
      background: #374151;
    }

    .sidebar button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    /* ==================================================
       STATUS LABELS ON BUTTONS
    ================================================== */
    .status-label {
      font-size: 10px;
      padding: 2px 6px;
      border-radius: 4px;
      margin-left: 8px;
      background: #374151;
      color: #fff;
      display: inline-block;
    }

    .status-label.processing {
      background: #f59e0b; /* –∂—ë–ª—Ç—ã–π */
      color: #000;
    }

    .status-label.completed {
      background: #10b981; /* –∑–µ–ª—ë–Ω—ã–π */
      color: #fff;
    }

    /* ==================================================
       MAIN SCENE
    ================================================== */
    .scene {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
      background: #e5e7eb;
    }

    .scene img {
      width: 90%;
      max-width: 900px;
      height: auto;
      border-radius: 16px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.3);
    }

    .preview-label {
      position: absolute;
      bottom: 24px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.7);
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 14px;
    }

    /* ==================================================
       MODAL
    ================================================== */
    .modal {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.7);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 10;
    }

    .modal.active {
      display: flex;
    }

    .modal-content {
      background: #fff;
      width: 90%;
      max-width: 800px;
      height: 80%;
      border-radius: 16px;
      overflow: hidden;
      position: relative;
    }

    .modal-content iframe {
      width: 100%;
      height: 100%;
      border: none;
    }

    .modal-close {
      position: absolute;
      top: 10px;
      right: 10px;
      background: #000;
      color: #fff;
      padding: 6px 10px;
      z-index: 2;
    }

    /* ==================================================
       ENDINGS (PAGES INSIDE ONE HTML)
    ================================================== */
    .ending {
      position: fixed;
      inset: 0;
      background: #111827;
      display: none;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: 24px;
      z-index: 20;
    }

    .ending.active {
      display: flex;
    }

    .ending-box {
      max-width: 600px;
      background: #1f2937;
      padding: 32px;
      border-radius: 16px;
    }

    .ending-box h1 {
      margin-top: 0;
    }

    /* ==================================================
       DEV PANEL (TOP RIGHT)
    ================================================== */
    .dev-panel {
      position: fixed;
      top: 12px;
      right: 12px;
      display: flex;
      gap: 8px;
      z-index: 100;
    }

    .dev-panel button {
      background: #020617;
      color: #fff;
      padding: 6px 10px;
      font-size: 12px;
      opacity: 0.85;
    }

    .dev-panel button:hover {
      opacity: 1;
    }

    /* ==================================================
       ADAPTIVE
    ================================================== */
    @media (max-width: 768px) {
      body {
        flex-direction: column;
      }

      .sidebar {
        width: 100%;
        flex-direction: row;
        flex-wrap: wrap;
      }

      .sidebar button {
        flex: 1 1 45%;
      }
    }
  </style>
</head>
<body>

<!-- ================= LEFT PANEL ================= -->
<div class="sidebar">
  <h2>–ö–æ—Ç–∏–∫ –ø–æ—Å–ª–µ —É—Ä–æ–∫–æ–≤</h2>

  <button id="boardBtn">
    –ü–æ—Ä–∞–±–æ—Ç–∞—Ç—å —É –¥–æ—Å–∫–∏
    <span class="status-label" id="boardStatus"></span>
  </button>

  <button id="tabletBtn">
    –ü–æ—Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –ø–ª–∞–Ω—à–µ—Ç–µ
    <span class="status-label" id="tabletStatus"></span>
  </button>

  <button id="playBtn">–ü–æ–∏–≥—Ä–∞—Ç—å</button>
  <button id="exitBtn">–í—ã–π—Ç–∏ –∏–∑ –∫–ª–∞—Å—Å–∞</button>
</div>

<!-- ================= MAIN SCENE ================= -->
<div class="scene">
  <img id="sceneImage" src="https://via.placeholder.com/900x500?text=–ö–ª–∞—Å—Å">
  <div class="preview-label" id="previewLabel">–ö–ª–∞—Å—Å</div>
</div>

<!-- ================= MODAL ================= -->
<div class="modal" id="modal">
  <div class="modal-content">
    <button class="modal-close" onclick="closeModal()">‚úï</button>
    <iframe id="modalFrame"></iframe>
  </div>
</div>

<!-- ================= ENDINGS ================= -->
<div class="ending" id="endingGood">
  <div class="ending-box">
    <h1>üôÇ –•–æ—Ä–æ—à–∞—è –∫–æ–Ω—Ü–æ–≤–∫–∞</h1>
    <p>‚Äî –ú–æ–ª–æ–¥–µ—Ü, –∫–æ—Ç–∏–∫. –¢—ã –æ—Ç–ª–∏—á–Ω–æ –ø–æ—Ä–∞–±–æ—Ç–∞–ª –∏ —Å–¥–µ–ª–∞–ª –≤—Å—ë –∫–∞–∫ —Å–ª–µ–¥—É–µ—Ç.</p>
  </div>
</div>

<div class="ending" id="endingNeutral">
  <div class="ending-box">
    <h1>üòê –ù–µ–π—Ç—Ä–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ü–æ–≤–∫–∞</h1>
    <p>‚Äî –¢—ã –ø—ã—Ç–∞–ª—Å—è, –Ω–æ –º–æ–≥ –±—ã –ø–æ—Å—Ç–∞—Ä–∞—Ç—å—Å—è –±–æ–ª—å—à–µ.</p>
  </div>
</div>

<div class="ending" id="endingBad">
  <div class="ending-box">
    <h1>üòæ –ü–ª–æ—Ö–∞—è –∫–æ–Ω—Ü–æ–≤–∫–∞</h1>
    <p>‚Äî –¢—ã —Å–æ–≤—Å–µ–º –Ω–µ –∑–∞–Ω–∏–º–∞–ª—Å—è. –¢–∞–∫ –¥–µ–ª–æ –Ω–µ –ø–æ–π–¥—ë—Ç.</p>
  </div>
</div>

<!-- ================= DEV PANEL ================= -->
<div class="dev-panel">
  <button onclick="showState()">State</button>
  <button onclick="resetGame()">Reset</button>
  <button onclick="forceEnding('good')">Good</button>
  <button onclick="forceEnding('neutral')">Neutral</button>
  <button onclick="forceEnding('bad')">Bad</button>
</div>

<script>
/* ==================================================
   STATE
================================================== */
const state = {
  boardStarted: localStorage.getItem('boardStarted') === 'true',
  boardPerfect: localStorage.getItem('boardPerfect') === 'true',
  tabletStarted: localStorage.getItem('tabletStarted') === 'true',
  tabletPerfect: localStorage.getItem('tabletPerfect') === 'true',
  playedPhone: localStorage.getItem('playedPhone') === 'true'
};

const sceneImage = document.getElementById('sceneImage');
const previewLabel = document.getElementById('previewLabel');
const modal = document.getElementById('modal');
const modalFrame = document.getElementById('modalFrame');

// üî¥ –ò–°–ü–†–ê–í–õ–ï–ù–û: –æ–±—ä—è–≤–ª–µ–Ω—ã –≤—Å–µ –∫–Ω–æ–ø–∫–∏
const boardBtn = document.getElementById('boardBtn');
const tabletBtn = document.getElementById('tabletBtn');
const playBtn = document.getElementById('playBtn');
const exitBtn = document.getElementById('exitBtn');

/* ==================================================
   UI
================================================== */
function updateButtons() {
  // –î–æ—Å–∫–∞
  if (state.boardPerfect) {
    boardBtn.disabled = true;
    document.getElementById('boardStatus').textContent = '‚úì –ø—Ä–æ–π–¥–µ–Ω–æ';
    document.getElementById('boardStatus').className = 'status-label completed';
  } else if (state.boardStarted) {
    boardBtn.disabled = false;
    document.getElementById('boardStatus').textContent = '–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ';
    document.getElementById('boardStatus').className = 'status-label processing';
  } else {
    boardBtn.disabled = false;
    document.getElementById('boardStatus').textContent = '';
    document.getElementById('boardStatus').className = 'status-label';
  }

  // –ü–ª–∞–Ω—à–µ—Ç
  if (state.tabletPerfect) {
    tabletBtn.disabled = true;
    document.getElementById('tabletStatus').textContent = '‚úì –ø—Ä–æ–π–¥–µ–Ω–æ';
    document.getElementById('tabletStatus').className = 'status-label completed';
  } else if (state.tabletStarted) {
    tabletBtn.disabled = false;
    document.getElementById('tabletStatus').textContent = '–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ';
    document.getElementById('tabletStatus').className = 'status-label processing';
  } else {
    tabletBtn.disabled = false;
    document.getElementById('tabletStatus').textContent = '';
    document.getElementById('tabletStatus').className = 'status-label';
  }
}
updateButtons();

/* ==================================================
   PREVIEW HOVERS
================================================== */
boardBtn.onmouseenter = () => {
  sceneImage.src = 'https://via.placeholder.com/900x500?text=–î–æ—Å–∫–∞';
  previewLabel.textContent = '–ü—Ä–µ–≤—å—é: –î–æ—Å–∫–∞';
};

tabletBtn.onmouseenter = () => {
  sceneImage.src = 'https://via.placeholder.com/900x500?text=–ü–ª–∞–Ω—à–µ—Ç';
  previewLabel.textContent = '–ü—Ä–µ–≤—å—é: –ü–ª–∞–Ω—à–µ—Ç';
};

document.querySelector('.sidebar').onmouseleave = () => {
  sceneImage.src = 'https://via.placeholder.com/900x500?text=–ö–ª–∞—Å—Å';
  previewLabel.textContent = '–ö–ª–∞—Å—Å';
};

/* ==================================================
   MODAL
================================================== */
function openModal(src) {
  modalFrame.src = src;
  modal.classList.add('active');
}

function closeModal() {
  modal.classList.remove('active');
  modalFrame.src = '';
}

/* ==================================================
   BUTTON LOGIC
================================================== */
boardBtn.onclick = () => {
  state.boardStarted = true;
  localStorage.setItem('boardStarted', 'true');
  updateButtons(); // ‚Üê —Å—Ä–∞–∑—É –ø–æ–∫–∞–∑–∞—Ç—å "–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ"
  openModal('games/maze/index.html');
};

tabletBtn.onclick = () => {
  state.tabletStarted = true;
  localStorage.setItem('tabletStarted', 'true');
  updateButtons(); // ‚Üê —Å—Ä–∞–∑—É –ø–æ–∫–∞–∑–∞—Ç—å "–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ"
  openModal('games/tic-tac-toe/index.html');
};

playBtn.onclick = () => {
  state.playedPhone = true;
  localStorage.setItem('playedPhone', 'true');
  openModal('games/fruit-catch/index.html');
};

exitBtn.onclick = () => {
  if (state.boardPerfect && state.tabletPerfect) {
    showEnding('good');
  } else if (state.boardStarted || state.tabletStarted) {
    showEnding('neutral');
  } else {
    showEnding('bad');
  }
};

/* ==================================================
   ENDINGS
================================================== */
function showEnding(type) {
  document.getElementById('endingGood').classList.remove('active');
  document.getElementById('endingNeutral').classList.remove('active');
  document.getElementById('endingBad').classList.remove('active');

  if (type === 'good') document.getElementById('endingGood').classList.add('active');
  if (type === 'neutral') document.getElementById('endingNeutral').classList.add('active');
  if (type === 'bad') document.getElementById('endingBad').classList.add('active');
}

/* ==================================================
   MINI-GAME CALLBACKS
================================================== */
window.markBoardPerfect = function () {
  state.boardPerfect = true;
  localStorage.setItem('boardPerfect', 'true');
  updateButtons();
  closeModal();
};

window.markTabletPerfect = function () {
  state.tabletPerfect = true;
  localStorage.setItem('tabletPerfect', 'true');
  updateButtons();
  closeModal();
};

/* ==================================================
   DEV PANEL
================================================== */
function showState() {
  alert(JSON.stringify(state, null, 2));
}

function resetGame() {
  if (!confirm('–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å?')) return;
  localStorage.clear();
  location.reload();
}

function forceEnding(type) {
  showEnding(type);
}
</script>
</body>
</html>
